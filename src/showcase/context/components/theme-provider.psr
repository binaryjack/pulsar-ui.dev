/**
 * Theme Provider Component
 * Provides theme context to children
 */

import { createSignal, createContext } from '@pulsar-framework/pulsar.dev';

interface ThemeProviderProps {
  children: JSX.Element
}

export const ThemeContext = createContext({
  theme: () => 'light',
  setTheme: () => {},
  primaryColor: () => '#3b82f6',
  setPrimaryColor: () => {}
});

export const ThemeProvider = (props: ThemeProviderProps) => {
  const [theme, setTheme] = createSignal('light');
  const [primaryColor, setPrimaryColor] = createSignal('#3b82f6');
  
  const themeValue = { theme, setTheme, primaryColor, setPrimaryColor };
  
  // SET VALUE SYNCHRONOUSLY before Provider renders
  // This ensures children can read context immediately
  ThemeContext.setValue(themeValue);
  
  // Pass children directly as HTMLElement, not as function
  return ThemeContext.Provider({ value: themeValue, children: props.children });
};
