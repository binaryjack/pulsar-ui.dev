/**
 * Multi-Context Dashboard
 * One component consuming THREE contexts simultaneously â€”
 * visually proves no prop drilling is needed.
 */

import { useContext } from '@pulsar-framework/pulsar.dev';
import { ThemeContext } from './theme-provider.psr';
import { UserContext } from './user-provider.psr';
import { SettingsContext } from './settings-provider.psr';

export const MultiContextDashboard = () => {
  const theme    = useContext(ThemeContext);
  const user     = useContext(UserContext);
  const settings = useContext(SettingsContext);

  return (
    <div>
      {/* Header */}
      <div style="margin-bottom: 16px; padding: 10px 14px; background: #1e1b4b; border: 1px solid #4f46e5; border-radius: 8px; display: flex; align-items: center; gap: 10px;">
        <span style="font-size: 20px;">ğŸ§©</span>
        <div>
          <p style="margin: 0; font-weight: 700; color: #a5b4fc; font-size: 14px;">MultiContextDashboard</p>
          <p style="margin: 2px 0 0 0; color: #6366f1; font-size: 12px;">Reads ThemeContext + UserContext + SettingsContext â€” zero props passed in</p>
        </div>
      </div>

      {/* Three context cards side by side */}
      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">

        {/* â”€â”€ ThemeContext card â”€â”€ */}
        <div style={() => `border: 2px solid ${theme.primaryColor()}; border-radius: 8px; overflow: hidden;`}>
          <div style={() => `padding: 8px 12px; background: ${theme.primaryColor()}22; border-bottom: 1px solid ${theme.primaryColor()}44;`}>
            <p style="margin: 0; font-size: 11px; font-weight: 700; color: #a78bfa; text-transform: uppercase; letter-spacing: 0.08em;">ğŸ¨ ThemeContext</p>
          </div>
          <div style="padding: 12px;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
              <span style="font-size: 18px;">{() => theme.theme() === 'dark' ? 'ğŸŒ™' : 'â˜€ï¸'}</span>
              <span style={() => `font-weight: 600; color: ${theme.primaryColor()}; font-size: 14px;`}>{theme.theme}</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
              <div style={() => `width: 20px; height: 20px; border-radius: 50%; background: ${theme.primaryColor()}; flex-shrink: 0;`}></div>
              <span style="color: #94a3b8; font-size: 12px; font-family: monospace;">{theme.primaryColor}</span>
            </div>
          </div>
        </div>

        {/* â”€â”€ UserContext card â”€â”€ */}
        <div style="border: 2px solid #10b981; border-radius: 8px; overflow: hidden;">
          <div style="padding: 8px 12px; background: #10b98122; border-bottom: 1px solid #10b98144;">
            <p style="margin: 0; font-size: 11px; font-weight: 700; color: #6ee7b7; text-transform: uppercase; letter-spacing: 0.08em;">ğŸ‘¤ UserContext</p>
          </div>
          <div style="padding: 12px;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
              <span style="font-size: 18px;">{() => user.isLoggedIn() ? 'ğŸŸ¢' : 'ğŸ”´'}</span>
              <span style={() => `font-weight: 600; color: ${user.isLoggedIn() ? '#10b981' : '#ef4444'}; font-size: 14px;`}>
                {() => user.isLoggedIn() ? 'Logged in' : 'Guest'}
              </span>
            </div>
            <div style="display: flex; flex-direction: column; gap: 2px;">
              <span style="color: #e2e8f0; font-size: 13px; font-weight: 500;">{() => user.user().name}</span>
              <span style="color: #64748b; font-size: 11px; text-transform: uppercase; letter-spacing: 0.05em;">{() => user.user().role}</span>
            </div>
          </div>
        </div>

        {/* â”€â”€ SettingsContext card â”€â”€ */}
        <div style="border: 2px solid #f59e0b; border-radius: 8px; overflow: hidden;">
          <div style="padding: 8px 12px; background: #f59e0b22; border-bottom: 1px solid #f59e0b44;">
            <p style="margin: 0; font-size: 11px; font-weight: 700; color: #fcd34d; text-transform: uppercase; letter-spacing: 0.08em;">âš™ï¸ SettingsContext</p>
          </div>
          <div style="padding: 12px; display: flex; flex-direction: column; gap: 6px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <span style="color: #94a3b8; font-size: 12px;">Font size</span>
              <span style="color: #fcd34d; font-weight: 600; font-size: 13px;">{() => `${settings.fontSize()}px`}</span>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <span style="color: #94a3b8; font-size: 12px;">Notifications</span>
              <span style={() => `font-weight: 600; font-size: 13px; color: ${settings.notifications() ? '#10b981' : '#ef4444'};`}>
                {() => settings.notifications() ? 'ON' : 'OFF'}
              </span>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <span style="color: #94a3b8; font-size: 12px;">Language</span>
              <span style="color: #fcd34d; font-weight: 600; font-size: 13px; text-transform: uppercase;">{() => settings.language()}</span>
            </div>
          </div>
        </div>
      </div>

      {/* Settings controls â€” only context not already controlled above */}
      <div style="padding: 12px 14px; background: #0f0f0f; border: 1px solid #1e293b; border-radius: 8px;">
        <p style="margin: 0 0 10px 0; font-size: 12px; font-weight: 600; color: #64748b; text-transform: uppercase; letter-spacing: 0.06em;">âš™ï¸ Adjust Settings (updates the card above in real-time)</p>
        <div style="display: flex; flex-wrap: wrap; gap: 12px; align-items: center;">

          {/* Font size slider */}
          <div style="display: flex; align-items: center; gap: 8px;">
            <span style="color: #94a3b8; font-size: 12px;">Font:</span>
            <button
              onClick={() => settings.setFontSize(Math.max(10, settings.fontSize() - 2))}
              style="padding: 2px 8px; background: #1e293b; color: #94a3b8; border: 1px solid #334155; border-radius: 4px; cursor: pointer; font-size: 14px;">âˆ’</button>
            <span style="color: #fcd34d; font-size: 13px; font-weight: 600; min-width: 28px; text-align: center;">{() => `${settings.fontSize()}px`}</span>
            <button
              onClick={() => settings.setFontSize(Math.min(28, settings.fontSize() + 2))}
              style="padding: 2px 8px; background: #1e293b; color: #94a3b8; border: 1px solid #334155; border-radius: 4px; cursor: pointer; font-size: 14px;">+</button>
          </div>

          {/* Notifications toggle */}
          <button
            onClick={() => settings.setNotifications(!settings.notifications())}
            style={() => `padding: 5px 12px; background: ${settings.notifications() ? '#10b98122' : '#ef444422'}; color: ${settings.notifications() ? '#10b981' : '#ef4444'}; border: 1px solid ${settings.notifications() ? '#10b981' : '#ef4444'}; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;`}>
            {() => settings.notifications() ? 'ğŸ”” Notifs ON' : 'ğŸ”• Notifs OFF'}
          </button>

          {/* Language selector */}
          <div style="display: flex; gap: 5px;">
            <button onClick={() => settings.setLanguage('en')} style={() => `padding: 4px 8px; background: ${settings.language() === 'en' ? '#f59e0b' : '#1e293b'}; color: ${settings.language() === 'en' ? '#000' : '#94a3b8'}; border: 1px solid ${settings.language() === 'en' ? '#f59e0b' : '#334155'}; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;`}>EN</button>
            <button onClick={() => settings.setLanguage('fr')} style={() => `padding: 4px 8px; background: ${settings.language() === 'fr' ? '#f59e0b' : '#1e293b'}; color: ${settings.language() === 'fr' ? '#000' : '#94a3b8'}; border: 1px solid ${settings.language() === 'fr' ? '#f59e0b' : '#334155'}; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;`}>FR</button>
            <button onClick={() => settings.setLanguage('de')} style={() => `padding: 4px 8px; background: ${settings.language() === 'de' ? '#f59e0b' : '#1e293b'}; color: ${settings.language() === 'de' ? '#000' : '#94a3b8'}; border: 1px solid ${settings.language() === 'de' ? '#f59e0b' : '#334155'}; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;`}>DE</button>
            <button onClick={() => settings.setLanguage('es')} style={() => `padding: 4px 8px; background: ${settings.language() === 'es' ? '#f59e0b' : '#1e293b'}; color: ${settings.language() === 'es' ? '#000' : '#94a3b8'}; border: 1px solid ${settings.language() === 'es' ? '#f59e0b' : '#334155'}; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;`}>ES</button>
            <button onClick={() => settings.setLanguage('ja')} style={() => `padding: 4px 8px; background: ${settings.language() === 'ja' ? '#f59e0b' : '#1e293b'}; color: ${settings.language() === 'ja' ? '#000' : '#94a3b8'}; border: 1px solid ${settings.language() === 'ja' ? '#f59e0b' : '#334155'}; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;`}>JA</button>
          </div>
        </div>
      </div>

      {/* Live preview â€” uses all 3 contexts at once */}
      <div style="margin-top: 12px; padding: 14px; border-radius: 8px; border: 1px dashed #334155;">
        <p style="margin: 0 0 6px 0; font-size: 11px; color: #475569; text-transform: uppercase; letter-spacing: 0.06em;">Live preview using all 3 contexts</p>
        <p style={() => `margin: 0; font-size: ${settings.fontSize()}px; color: ${theme.primaryColor()}; font-weight: 500;`}>
          {() => (user.isLoggedIn() ? 'ğŸ‘‹ Hello, ' + user.user().name : 'ğŸ‘‹ Hello, Guest') + ' â€” theme: ' + theme.theme() + ', lang: ' + settings.language().toUpperCase()}
        </p>
      </div>
    </div>
  );
};
