/**
 * PHASE 1: Core Reactivity Tests
 * Testing: Signals, Effects, Memos, and Hooks
 */

import { createSignal, createEffect, createMemo, batch } from '@pulsar-framework/pulsar.dev';

export component ReactivityTestPage() {
  // Test 1: Multiple Signals
  const [firstName, setFirstName] = createSignal('John');
  const [lastName, setLastName] = createSignal('Doe');
  const [age, setAge] = createSignal(25);
  
  // Test 2: Memos (Computed Values)
  const fullName = createMemo(() => `${firstName()} ${lastName()}`);
  const isAdult = createMemo(() => age() >= 18);
  
  // Test 3: Effect with Dependencies
  createEffect(() => {
    console.log(`[Effect] Full name changed to: ${fullName()}`);
  });
  
  // Test 4: Batch Updates
  const updateAll = () => {
    batch(() => {
      setFirstName('Jane');
      setLastName('Smith');
      setAge(30);
    });
  };
  
  const resetAll = () => {
    batch(() => {
      setFirstName('John');
      setLastName('Doe');
      setAge(25);
    });
  };
  
  return (
    <div>
      <h2 style="font-size: 32px; margin-bottom: 20px; color: #10b981;">
        üß™ Phase 1: Core Reactivity Tests
      </h2>
      
      {/* Test 1: Multiple Signals */}
      <section style="background: #1a1a1a; padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #3b82f6;">
        <h3 style="font-size: 24px; margin-bottom: 15px; color: #3b82f6;">
          1Ô∏è‚É£ Multiple Signals
        </h3>
        <div style="margin-bottom: 15px;">
          <div style="margin-bottom: 10px;">
            <strong style="color: #10b981;">First Name:</strong> {firstName()}
          </div>
          <div style="margin-bottom: 10px;">
            <strong style="color: #10b981;">Last Name:</strong> {lastName()}
          </div>
          <div style="margin-bottom: 10px;">
            <strong style="color: #10b981;">Age:</strong> {age()}
          </div>
        </div>
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
          <button 
            onClick={() => setFirstName('Alice')}
            style="padding: 10px 20px; background: #3b82f6; border: none; color: white; border-radius: 6px; cursor: pointer; font-size: 14px;">
            Set First: Alice
          </button>
          <button 
            onClick={() => setLastName('Johnson')}
            style="padding: 10px 20px; background: #3b82f6; border: none; color: white; border-radius: 6px; cursor: pointer; font-size: 14px;">
            Set Last: Johnson
          </button>
          <button 
            onClick={() => setAge(age() + 1)}
            style="padding: 10px 20px; background: #3b82f6; border: none; color: white; border-radius: 6px; cursor: pointer; font-size: 14px;">
            Increment Age
          </button>
        </div>
      </section>
      
      {/* Test 2: Memos */}
      <section style="background: #1a1a1a; padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #8b5cf6;">
        <h3 style="font-size: 24px; margin-bottom: 15px; color: #8b5cf6;">
          2Ô∏è‚É£ Computed Values (Memos)
        </h3>
        <div style="margin-bottom: 15px;">
          <div style="margin-bottom: 10px;">
            <strong style="color: #10b981;">Full Name (computed):</strong> {fullName()}
          </div>
          <div style="margin-bottom: 10px;">
            <strong style="color: #10b981;">Is Adult (computed):</strong> {isAdult() ? '‚úÖ Yes' : '‚ùå No'}
          </div>
        </div>
        <p style="color: #9ca3af; font-size: 14px;">
          ‚ÑπÔ∏è Memos auto-update when dependencies (firstName, lastName, age) change
        </p>
      </section>
      
      {/* Test 3: Effects */}
      <section style="background: #1a1a1a; padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #10b981;">
        <h3 style="font-size: 24px; margin-bottom: 15px; color: #10b981;">
          3Ô∏è‚É£ Side Effects (createEffect)
        </h3>
        <p style="color: #9ca3af; font-size: 14px; margin-bottom: 10px;">
          ‚ÑπÔ∏è Open browser console to see effect logs when name changes
        </p>
        <div style="background: #0a0a0a; padding: 15px; border-radius: 6px; font-family: monospace; color: #22c55e;">
          console.log: Effect runs on fullName() changes
        </div>
      </section>
      
      {/* Test 4: Batch Updates */}
      <section style="background: #1a1a1a; padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #f59e0b;">
        <h3 style="font-size: 24px; margin-bottom: 15px; color: #f59e0b;">
          4Ô∏è‚É£ Batched Updates
        </h3>
        <p style="color: #9ca3af; font-size: 14px; margin-bottom: 15px;">
          ‚ÑπÔ∏è batch() updates multiple signals without triggering intermediate effects
        </p>
        <div style="display: flex; gap: 10px;">
          <button 
            onClick={updateAll}
            style="padding: 10px 20px; background: #f59e0b; border: none; color: white; border-radius: 6px; cursor: pointer; font-size: 14px;">
            Update All (Batched)
          </button>
          <button 
            onClick={resetAll}
            style="padding: 10px 20px; background: #6b7280; border: none; color: white; border-radius: 6px; cursor: pointer; font-size: 14px;">
            Reset All
          </button>
        </div>
      </section>
      
      {/* Status Summary */}
      <section style="background: #1a1a1a; padding: 20px; border-radius: 8px; border: 2px solid #10b981;">
        <h3 style="font-size: 20px; margin-bottom: 15px; color: #10b981;">
          ‚úÖ Test Status
        </h3>
        <ul style="list-style: none; padding: 0; color: #9ca3af;">
          <li style="margin-bottom: 8px;">‚úÖ Multiple signals working</li>
          <li style="margin-bottom: 8px;">‚è≥ Memos (computed values)</li>
          <li style="margin-bottom: 8px;">‚è≥ Effects (side effects)</li>
          <li style="margin-bottom: 8px;">‚è≥ Batch updates</li>
        </ul>
      </section>
    </div>
  );
}
